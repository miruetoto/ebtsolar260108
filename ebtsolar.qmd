---
title: "Spatio-Temporal Graph Neural Networks with Elastic-Band Transform for Solar Radiation Prediction"
subtitle: "Multiscale Workshop 2026"
author: "Guebin Choi"
institute: "Department of Statistics, Jeonbuk National University"
date: "2026-01-07"
bibliography: ref.bib
format:
  revealjs:
    theme: custom.scss
    slide-number: true
    chalkboard: false
    preview-links: auto
    transition: none
    width: 1600
    height: 900
    smaller: true
    scrollable: true
    fig-format: png
    fig-dpi: 300
    auto-stretch: true
    html-math-method: mathjax
---

## Characteristics of Solar Irradiance Time Series

:::: {.columns}
::: {.column width="60%"}
![**Figure:** Example of solar irradiance time series observed in Seoul. Strong daily periodicity coexists with irregular fluctuations caused by weather conditions.](figs/fig1.png){width="100%"}
:::
::: {.column width="40%"}
**Strong periodicity, yet challenging structure for analysis**

1. **Not a sinusoid**: Half-wave pattern → Limitations in applying Fourier-based decomposition

2. **Not an exact period**: Sunrise/sunset times vary by season → Not strictly a 24-hour cycle

**Nighttime zero-inflation problem**

- Irradiance is **structurally zero** during nighttime → Standard time series methods have limited applicability
- Models assuming continuous time series (AR, LSTM) face difficulties
:::
::::

## Problem: Performance Improvement Requires Reflecting Data Characteristics

> **Key insight**: Without considering the structural characteristics of solar irradiance (daily periodicity, nighttime zeros), fundamental limitations exist in improving prediction performance

**Limitations of traditional time series models**

- **Statistical models**: ARMA, ARIMA violate stationarity assumptions due to nighttime zero intervals
- **Deep learning models**: TCN, LSTM, CNN-LSTM also assume continuous time series structure → Learning distortion in zero-value intervals

**What if we exclude nighttime zero intervals?**

1. **Seasonality issue**: Sunrise/sunset times differ by season → Cannot uniformly exclude "7PM~6AM"
2. **Weather condition confusion**: Excluding intervals where irradiance ≈ 0 → Risk of **also excluding low irradiance on cloudy days**

**What if we decompose the daily periodic component?**

- Existing decomposition methods (STL, EMD, Wavelet) **cannot clearly separate** the daily periodic component

## Solution: Paradigm Shift to Hierarchical Modeling

> **Key perspective**: Not simply "previous time → next time" direct prediction, but a **dual structure of "sunrise determination + conditional irradiance prediction"**

**Modeling strategy**

- First determine **sunrise indicator** for the next time point
- Model the **conditional distribution** of solar irradiance given sunrise condition

**Prior work** [@lee2021short]

- Proposed a mixture model introducing **latent variables** representing sunrise status
- Parameter estimation and prediction via **EM algorithm (Expectation-Maximization)**

## This Study: Single-Site Prediction → Multi-Regional Simultaneous Forecasting

:::: {.columns}
::: {.column width="60%"}
![**Figure:** Solar irradiance time series observed simultaneously across multiple regions in Korea. Geographically closer locations exhibit higher similarity in their patterns.](figs/fig2.png){width="100%"}
:::
::: {.column width="40%"}
**Extension of problem definition**

- Single-site time series prediction → **Multivariate spatio-temporal forecasting**
- Temporal data → Problem redefinition as **Spatio-Temporal data**

**Spatial Dependency**

- Geographically adjacent regions **share similar meteorological patterns**

**Rationale for STGNN (Spatio-Temporal Graph Neural Network)**

- **Explicit modeling** of inter-regional spatial dependencies via graph structure
- Station = node, observation = node signal

**Graph-based data representation**

$$\mathcal{G} = (\mathcal{V}, \mathbf{A}, \{y_{v,t}\})$$
:::
::::

## Core Challenge in STGNN: Defining the Adjacency Matrix

> **Key issue**: Node connectivity must be defined prior to STGNN application

**Absence of adjacency matrix $\mathbf{A}$**

- Most STGNN studies **assume** the adjacency matrix $\mathbf{A}$ is **given a priori**
- However, in real applications, this information is often **not explicitly provided**

**Differences in adjacency matrix definition across application domains**

<div style="width: fit-content; margin: auto;">

| Domain | Adjacency Matrix $\mathbf{A}$ Definition |
|:---:|:---|
| Traffic networks | Road connectivity is **physically explicit** |
| Meteorological observation networks | Inter-regional connectivity is **not self-evident** |

</div>

**Therefore, the problem of estimating $\mathbf{A}$ from data arises**

## Method 1 for Estimating $\mathbf{A}$: Distance-Based Approach

:::: {.columns}
::: {.column width="60%"}
![**Figure:** Comparison of solar irradiance patterns between 대전–서산 (96.2 km) and 철원–인천 (94.9 km). Although the geographical distances are nearly identical, the irradiance variations differ substantially.](figs/fig3.png){width="100%"}
:::
::: {.column width="40%"}
**Distance-based approach**

- Define edge weights as a **function of geographical distance** (e.g., Gaussian kernel)
- **Assumption**: Physical proximity ≈ pattern similarity

**Limitation: Distance ≠ Climatological Similarity**

- Even with similar physical distances, climate patterns differ based on **topographical characteristics (coastal/inland, elevation, etc.)**

<div style="width: fit-content; margin: auto;">

| Region pair | Distance | Pattern similarity |
|:---:|:---:|:---|
| 대전-서산 | 96.2 km | **Low** (서산: maritime climate) |
| 철원-인천 | 94.9 km | **High** (similar climate zone) |

</div>

→ **Physical distance alone cannot sufficiently explain climatological similarity**
:::
::::

## Method 2 for Estimating $\mathbf{A}$: Correlation-Based Approach

:::: {.columns}
::: {.column width="50%"}
![**Figure:** Correlation matrix of solar irradiance among all stations in Korea. Overall correlations are very high, with the lowest value observed between 서울 and 흑산도 (0.6422).](figs/fig4.png){width="90%"}
:::
::: {.column width="50%"}
**Data-driven approach**

- Quantify similarity via **sample correlation coefficients** between time series

**Analysis results**

- **High correlations observed** among most of the 44 stations nationwide
- Minimum: **$r = 0.6422$** between 서울 and 흑산도
- **Significantly higher** than intuitive expectations
- **Discrepancy** with actual climatological similarity

**Cause analysis**

> **Nighttime zero-inflation** shared across all stations **artificially inflates** sample correlation coefficients
:::
::::

## Visualization of Spurious Correlation

:::: {.columns}
::: {.column width="50%"}
![**Figure:** Comparison of solar irradiance time series: 서울–흑산도 (top, correlation = 0.6422) and 고창–영광 (bottom, correlation = 0.9681).](figs/fig5.png){width="100%"}
:::
::: {.column width="50%"}

<div style="width: fit-content; margin: auto;">

| Region pair | Correlation | Actual pattern |
|:---:|:---:|:---|
| 고창-영광 | 0.9681 | High similarity (adjacent regions) |
| 서울-흑산도 | 0.6422 | **Effectively inverse pattern** |

</div>

**서울-흑산도 case analysis**

- Visually shows patterns closer to **negative correlation**
- Yet sample correlation coefficient is **positive at $r = 0.64$**

**Problem from a modeling perspective**

If this correlation is directly reflected in the adjacency matrix, 흑산도 information is included with **weight 0.6** when predicting 서울

→ Valid for nighttime prediction, but **acts as noise for daytime prediction**
:::
::::

## Proposed Method: Multiplicative Decomposition

**Two perspectives on signal decomposition: Additive vs. Multiplicative models**

Product-to-sum identity for trigonometric functions:

$$\cos(58\pi t) + \cos(62\pi t) = 2\cos(60\pi t) \cdot \cos(2\pi t)$$

- **Left side**: **Additive combination** of two frequency components
- **Right side**: **Multiplicative combination** of carrier and envelope

**Multiplicative decomposition of solar irradiance time series**

$$y_{v,t} = y_{v,t}^U \times y_{v,t}^P$$

<div style="width: fit-content; margin: auto;">

| Component | Physical meaning | Characteristics |
|:---:|:---|:---|
| $y_{v,t}^U$ | **Amplitude Modulation** — reflects weather conditions | Upper envelope, slowly varying |
| $y_{v,t}^P$ | **Periodic Component** — solar elevation pattern | Normalized daily pattern ($\in [0,1]$) |

</div>

## EBT (Elastic-Band Transform) Decomposition Algorithm {.scrollable}

::: {style="overflow-y: auto; max-height: 800px;"}
![**Figure:** Illustration of the EBT decomposition process for solar irradiance time series. Left: Construction of elastic bands with τ=24 and extraction of the upper envelope (red curve). Right: Decomposed components showing the amplitude modulation component (top) and the normalized periodic component (bottom).](figs/sec32_fig1.png){width="100%"}
:::

**EBT-based multiplicative decomposition** [@choi2023elastic; @choi2024decomposition]

- **Left panel**: Construct Elastic Bands with $\tau=24$ hour units → Extract Upper Envelope $u_{v,t}^{\mathbf{y}_v,\tau}$
- **Top right**: Amplitude modulation component $y_{v,t}^U = u_{v,t}^{\mathbf{y}_v,\tau}$ — Maximum attainable irradiance given weather conditions
- **Bottom right**: Periodic component $y_{v,t}^P = y_{v,t} / (y_{v,t}^U + \epsilon)$ — Normalized daily pattern from solar elevation

## Changes in Spatial Correlation Structure After Decomposition {.scrollable}

::: {style="overflow-y: auto; max-height: 800px;"}
![**Figure:** Spatial correlation structure of EBT-decomposed components. Top: Sample time series of $y_{v,t}$, $y_{v,t}^P$, and $y_{v,t}^U$ from seven regions. Bottom: Correlation matrices showing uniform high correlations for the periodic component and structured regional clustering for the amplitude modulation component.](figs/corr_grid_plot_v3.png){width="100%"}
:::

**Verification of decomposition results**

- **Periodic component** $y^P$: Correlation matrix exhibits **Dense** structure — Nearly identical patterns nationwide ($r_{v,s}^P \approx 1$)
- **Amplitude modulation component** $y^U$: Correlation matrix exhibits **Sparse** structure — **Block structure** emerges among climatologically similar regions

## Proposed Framework Overview {.scrollable}

::: {style="overflow-y: auto; max-height: 800px;"}
![**Figure:** Process of decomposing the raw time series into a periodic component and an amplitude modulation component using the EBT, constructing separate graphs, applying STGNN-based models to each component independently, and recombining the two prediction results to obtain the final forecast.](pipeline.png){width="100%"}
:::

**Core strategy**: Apply independent STGNNs to each decomposed component, then recombine

$$\hat{y}_{v,t+h} = \hat{y}_{v,t+h}^U \times \hat{y}_{v,t+h}^P$$

## Advantages of the Proposed Framework

**1. Component-Specific Optimized Graph Structure**

<div style="width: fit-content; margin: auto;">

| Component | Graph structure | Rationale |
|:---:|:---:|:---|
| Periodic $y^P$ | **Dense** | Daily periodic pattern is similar nationwide ($r_{v,s}^P \approx 1$) → Utilize all regional information |
| Amplitude $y^U$ | **Sparse** | Only climatologically similar regions have meaningful correlations → Selective information utilization |

</div>

**2. Reduced modeling complexity**

- **Periodic component**: Regular pattern → Easy to learn
- **Amplitude component**: Periodicity removed, **simplified temporal structure**

**3. Component-specific hyperparameter optimization**

<div style="width: fit-content; margin: auto;">

| Component | Optimal Lag | Number of filters |
|:---:|:---:|:---|
| Periodic $y^P$ | **lag = 24** (capture full daily cycle) | Many required |
| Amplitude $y^U$ | **lag = 4** (short-term dependency sufficient) | Few sufficient |

</div>

## STGNN Architectures Used in Experiments

<div style="width: fit-content; margin: auto;">

| Model | Temporal | GNN Layer | Key characteristics |
|:---:|:---:|:---:|:---|
| **GConvGRU** | GRU | Chebyshev | Spectral graph convolution within GRU gates |
| **GConvLSTM** | LSTM | Chebyshev | Includes peephole connection |
| **T-GCN** | GRU | GCN | Lightweight first-order approximation |
| **DCRNN** | GRU | DiffConv | Bidirectional diffusion convolution |

</div>

**References**: @seo2018structured, @zhao2019t, @li2017diffusion, @rozemberczki2021pytorch

## Experimental Setup

- **Data**: 44 observation stations in South Korea, $T = 2{,}568$ time points (approximately 107 days of hourly observations)
- **Data split**: Training 80% / Test 20%
- **Notable test period event**: **Typhoon Hinnamnor** in early September 2022 [@digital_typhoon]

**Comparison of three prediction strategies**

<div style="width: fit-content; margin: auto;">

| Strategy | Description |
|:---:|:---|
| **Classic** | Direct prediction of raw time series $y_{v,t}$ with single STGNN (baseline) |
| **Proposed $(L,L)$** | Same lag $L$ applied to both components after EBT decomposition |
| **Proposed $(4,L)$** | $y_{v,t}^U$ uses lag=4, $y_{v,t}^P$ uses lag=$L$ (asymmetric setting) |

</div>

## Experimental Results: GConvGRU (MSE) {.scrollable}

<div style="width: fit-content; margin: auto;">

| Lag | F | Classic | Proposed (L,L) | Proposed (4,L) |
|:---:|:---:|:---:|:---:|:---:|
| 8 | 8 | 0.0535<sub>±0.0011</sub> | 0.0430<sub>±0.0021</sub> | [**0.0419**<sub>±0.0007</sub>]{style="color: red;"} |
| 8 | 16 | 0.0537<sub>±0.0012</sub> | 0.0413<sub>±0.0008</sub> | [**0.0408**<sub>±0.0010</sub>]{style="color: red;"} |
| 8 | 24 | 0.0535<sub>±0.0011</sub> | 0.0416<sub>±0.0010</sub> | [**0.0404**<sub>±0.0007</sub>]{style="color: red;"} |
| 8 | 32 | 0.0541<sub>±0.0005</sub> | 0.0408<sub>±0.0012</sub> | [**0.0400**<sub>±0.0003</sub>]{style="color: red;"} |
| 12 | 8 | 0.0534<sub>±0.0012</sub> | 0.0438<sub>±0.0013</sub> | [**0.0426**<sub>±0.0006</sub>]{style="color: red;"} |
| 12 | 16 | 0.0544<sub>±0.0008</sub> | 0.0426<sub>±0.0010</sub> | [**0.0416**<sub>±0.0004</sub>]{style="color: red;"} |
| 12 | 24 | 0.0548<sub>±0.0008</sub> | 0.0423<sub>±0.0017</sub> | [**0.0415**<sub>±0.0004</sub>]{style="color: red;"} |
| 12 | 32 | 0.0549<sub>±0.0007</sub> | 0.0427<sub>±0.0017</sub> | [**0.0411**<sub>±0.0004</sub>]{style="color: red;"} |
| 24 | 8 | 0.0657<sub>±0.0023</sub> | 0.0512<sub>±0.0016</sub> | [**0.0461**<sub>±0.0013</sub>]{style="color: red;"} |
| 24 | 16 | 0.0662<sub>±0.0018</sub> | 0.0499<sub>±0.0029</sub> | [**0.0471**<sub>±0.0007</sub>]{style="color: red;"} |
| 24 | 24 | 0.0675<sub>±0.0024</sub> | 0.0507<sub>±0.0026</sub> | [**0.0470**<sub>±0.0008</sub>]{style="color: red;"} |
| 24 | 32 | 0.0677<sub>±0.0010</sub> | 0.0503<sub>±0.0013</sub> | [**0.0472**<sub>±0.0007</sub>]{style="color: red;"} |

</div>

→ **The proposed method shows consistent performance improvement over baseline across all settings** (approximately 20-30% MSE reduction)

## Typhoon Hinnamnor Period: Robustness Under Extreme Weather {.scrollable}

::: {style="overflow-y: auto; max-height: 800px;"}
![**Figure:** Top 9 regions by typhoon period improvement rate. Left: Geographical distribution. Right: Time series comparison during Typhoon Hinnamnor (Aug 30 – Sep 8, 2022). Red shading indicates core impact period (Sep 4–6).](figs/251121_top9_typhoon_map_timeseries_geojson.png){width="100%"}
:::

**Performance improvement of the proposed method is more pronounced under extreme weather conditions**

## Regional Performance Improvement During Typhoon Period (MSE Reduction)

<div style="width: fit-content; margin: auto;">

| # | Region | Classic | Proposed | MSE Reduction |
|:---:|:---|:---:|:---:|:---:|
| 1 | 경주 | 0.0791 | 0.0436 | [**44.9%**]{style="color: red;"} |
| 2 | 함양 | 0.0596 | 0.0343 | [**42.5%**]{style="color: red;"} |
| 3 | 창원 | 0.0644 | 0.0375 | [**41.8%**]{style="color: red;"} |
| 4 | 의령 | 0.0561 | 0.0353 | **37.1%** |
| 5 | 부산 | 0.0753 | 0.0493 | **34.5%** |
| 6 | 고산 | 0.0388 | 0.0257 | **33.8%** |
| 7 | 양산 | 0.0746 | 0.0497 | **33.4%** |
| 8 | 김해 | 0.0725 | 0.0485 | **33.1%** |
| 9 | 청송 | 0.0539 | 0.0363 | **32.6%** |

</div>

→ Achieved **32-45% MSE reduction** in regions along the typhoon path (southeastern Korean Peninsula)

## Main Contributions

**1. Multiplicative Decomposition Framework**

- Introduction of **$y = y^U \times y^P$ decomposition model** for solar irradiance time series
- **Fundamental resolution** of the spurious correlation problem caused by periodicity

**2. Asymmetric Component Modeling**

- **Independent graph structure and hyperparameter optimization** tailored to each component's spatio-temporal characteristics
- Amplitude: short lag (lag=4), sparse graph / Periodic: long lag (lag=24), dense graph

**3. Robustness Under Extreme Weather Conditions**

- Achieved **32-45% MSE reduction** during Typhoon Hinnamnor period

## Reviewer Question 1: Comparison with Alternative Decomposition Methods

> *"Comparative analyses with alternative decomposition techniques such as STL, EMD, or wavelet methods would strengthen the argument that EBT provides distinct advantages."*

**Comparison targets**: STL [@cleveland1990stl], EMD [@huang1998empirical], Wavelet [@mallat2002theory] vs EBT

<div style="width: fit-content; margin: auto;">

| Method | Decomposition type | Decomposition result |
|:---:|:---:|:---|
| STL | Additive | Daily periodic component remains in residual |
| EMD | Additive | Periodic component not clearly separated into specific IMF |
| Wavelet | Additive | Periodic energy dispersed across multiple levels |
| **EBT** | **Multiplicative** | **Clear two-component decomposition** ($y^U$, $y^P$) |

</div>

→ **Additive decomposition methods (STL, EMD, Wavelet) are unsuitable for the structural characteristics of solar irradiance**

## Decomposition Method Comparison: Raw Scale {.scrollable}

::: {style="overflow-y: auto; max-height: 800px;"}
![**Figure:** Decomposition comparisons on the raw-scale irradiance series for 서울 (2022-09-01 to 2022-09-15). Top: EBT multiplicative decomposition. Middle rows: STL and EMD additive decompositions. Bottom: Wavelet (db4, level 4) additive decomposition.](figs/A1_fig1.png){width="100%"}
:::

## Decomposition Method Comparison: Log Scale {.scrollable}

::: {style="overflow-y: auto; max-height: 800px;"}
![**Figure:** Decomposition comparisons on the log-transformed irradiance series for 서울 (2022-09-01 to 2022-09-15). Top: EBT multiplicative decomposition. Middle rows: STL and EMD multiplicative decompositions. Bottom: Wavelet (db4, level 4) multiplicative decomposition.](figs/A1_fig2.png){width="100%"}
:::

## Reviewer Question 2: Comparison with Non-Graph Deep Learning Models

> *"Comparisons with non-graph deep learning baselines such as LSTM, CNN-LSTM, or temporal convolutional networks would help clarify the specific advantages of the proposed approach."*

**Comparison models**: TCN, LSTM, CNN-LSTM [@bai2018tcn; @hochreiter1997lstm; @agga2021short] (2000 epochs, 10 repetitions)

<div style="width: fit-content; margin: auto;">

| Model | MSE | Setting |
|:---:|:---:|:---:|
| TCN | 0.0601<sub>±.0012</sub> | L=24 |
| LSTM | 0.0841<sub>±.0023</sub> | L=8 |
| CNN-LSTM | 0.0975<sub>±.0037</sub> | L=8 |
| **Proposed (EBT+STGNN)** | [**0.0400**<sub>±.0003</sub>]{style="color: red;"} | L=8 |

</div>

→ **33% MSE reduction** compared to the best non-spatial model (TCN) — **Demonstrates the effectiveness of spatial dependency modeling**

## Thank You

**Paper information**

**"Spatio-Temporal Graph Neural Networks with Elastic-Band Transform for Solar Radiation Prediction"**

*CMES-Computer Modeling in Engineering & Sciences*, 2025

**Contact**: guebin.choi@jbnu.ac.kr

## References
